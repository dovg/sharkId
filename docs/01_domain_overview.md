# Система учета и идентификации тигровых акул — предметная область

## Контекст

Подводный биолог ежедневно выполняет несколько погружений и фотографирует тигровых акул.  
Каждая акула имеет уникальный рисунок пятен около морды, по которому можно отличать особей.

Система предназначена для:

- ведения каталога акул,
    
- автоматической идентификации особей по фото,
    
- хранения фотоархива,
    
- ведения журнала наблюдений,
    
- группировки наблюдений по погружениям,
    
- управления справочником локаций.
    

Автоклассификация выполняется автоматически, но итоговое решение **всегда подтверждается пользователем**.

Авторизация обязательна. Ролевая модель в MVP отсутствует (один тип пользователя).

---

## Поддерживаемые форматы изображений

- image/jpeg
    
- image/png
    

Другие форматы отклоняются при загрузке.

---

## Основные сущности предметной области

### 1. Shark (Акула)

Каталожная сущность — идентифицированная особь.

Поля:

- id
    
- display_name
    
- name_status (temporary | confirmed)
    
- created_at
    
- profile_photos (эталонные фото)
    
- связанные наблюдения
    

Особенности:

- При создании новой акулы система предлагает временное имя из списка женских персонажей Гарри Поттера.
    
- Пользователь может принять имя или заменить вручную.
    
- Имя может оставаться временным.
    

---

### 2. Photo (Фото)

Фото загружается без привязки к акуле.

Поля:

- id
    
- object_key (ключ объекта в MinIO)
    
- uploaded_at
    
- content_type
    
- size
    
- exif_payload (JSON, сохраняем всё)
    
- нормализованные поля (taken_at, gps_lat, gps_lon и т.п.)
    
- статус обработки
    
- список top-5 кандидатов + score
    

Статусы:

- uploaded
    
- processing
    
- ready_for_validation
    
- error
    

---

### 3. DiveSession (Погружение)

Группирует фото и наблюдения.

Поля:

- id
    
- started_at
    
- ended_at
    
- location_id
    
- comment
    
- список photo_id
    

---

### 4. Observation (Наблюдение)

Запись журнала встречи акулы.

Поля:

- id
    
- dive_session_id
    
- shark_id
    
- photo_id
    
- taken_at
    
- location_id
    
- comment
    
- confirmed_at
    

Правила:

- Создаётся автоматически как черновик.
    
- Подтверждение пользователем требуется всегда.
    
- Если метаданных не хватает — пользователь заполняет вручную.
    

- Обязателен механизм регулярного бэкапа (БД + MinIO).